---
name: idea-workflow-v2
description: 市場リサーチベースの自律アイデア生成 + PDCA評価 + MD仕様書生成。1日2回（朝9:00/夜21:00 JST）自動実行。
triggers:
  - cron（朝9:00 JST, 夜21:00 JST）
  - heartbeat（該当時間帯にトリガー）
  - 手動（#labで「アイデア出して」等）
---

# Idea Workflow v2 — 市場リサーチ × 自律アイデア生成

## 目的

エビデンスベースで「勝てるアイデア」を自律的に生成し、洗練された実装仕様書（MD）を作成。
最終的にClaude Code Agent が実装 → `slack-for-idea` リポジトリのギャラリーに追加される。

---

## パス定義

```
Vault Ideas:     /mnt/vault/10-Ideas/
Vault Projects:  /mnt/vault/20-Projects/
State:           memory/auto-idea-state.json
Learning:        memory/idea-learning.md
Keywords:        memory/idea-keywords.json
Processed:       /mnt/vault/10-Ideas/.processed/
```

---

## 実行スケジュール

| スロット | 時刻(JST) | UTC |
|---------|-----------|-----|
| morning | 09:00 | 00:00 |
| evening | 21:00 | 12:00 |

**重複防止:** `auto-idea-state.json` の `lastRun` から6時間未満なら実行しない。

---

## 実行フロー

### Step 0: 準備（必須）

1. `memory/idea-learning.md` を読む → 過去の学びを把握
2. `memory/idea-keywords.json` を読む → 今回のキーワードとメソッドを決定
3. `memory/auto-idea-state.json` を読む → 重複チェック、直近カテゴリ確認

### Step 1: カテゴリ + 着想メソッド決定

**カテゴリ**（直近3回と被らないものから選ぶ）:
```
categories:
  - Chrome拡張
  - SaaSダッシュボード
  - ランディングページ/Webツール
  - モバイルWebアプリ
  - GAS/スプレッドシート連携
  - CLI/開発者ツール
  - EC/マーケットプレイス連携
  - 教育/学習ツール
  - SNS/コミュニティツール
  - 業務効率化ツール
```

**着想メソッド**（直近2回と被らないものから選ぶ）:
```
methods:
  A: 海外トレンド → 日本ローカライズ
  B: 既存ツールの弱点 → 特化版
  C: 2つの分野の掛け算 → 新カテゴリ
  D: マスターの実体験/不満 → 解決策
  E: コミュニティの質問/不満 → プロダクト化
  F: 料金が高いサービス → 安い代替
```

### Step 2: 市場リサーチ（web_search × 2 + web_fetch × 1-2）

`idea-keywords.json` の `trend_queries` からランダムに選んだキーワードで検索。

**検索1回目:** トレンド発見
```
web_search: "{キーワード} + {カテゴリ関連語}"
→ 売れているプロダクト、伸びている領域を特定
```

**検索2回目:** 競合・ニッチ分析
```
web_search: "{発見したプロダクト名} alternative OR competitor OR 代替"
→ 競合の弱点、未対応領域を特定
```

**web_fetch:** 有望な記事・プロダクトページを深掘り
```
web_fetch: 発見した事例の詳細ページ
→ 売上データ、ユーザー数、レビュー、不満点を収集
```

**収集すべきエビデンス（最低1つ必須）:**
- 市場の売上/ユーザー数の実数値
- ユーザーの具体的な不満（レビュー、Reddit、X等）
- 競合が対応していない機能/市場

### Step 3: アイデア着想

**制約条件（必須）:**
```yaml
must:
  - 収益化可能（課金 or 広告 or リード獲得が見える）
  - エンドユーザーが存在する（開発者以外も含む）
  - マスターのスキルで2週間以内にMVP可能
    （JS/TS, Chrome拡張, 静的サイト, GAS, Next.js）
  - エビデンスが1つ以上ある

should:
  - ¥500-5,000の価格帯（買い切り or 月額）
  - 既存競合より1つ明確な優位性
  - 日本市場で特にニーズあり

never:
  - OpenClaw内部ツール（自分用ユーティリティ）
  - AI wrapper そのもの（差別化困難）
  - 大規模インフラ必要なもの
  - 既に飽和しているカテゴリ（TODO, メモアプリ等）
```

### Step 4: PDCA評価（最大2イテレーション）

#### 定量スコアリング基準

**PUGEF（10点満点）:**
| 基準 | 2点 | 4点 | 6点 | 8点 | 10点 |
|------|-----|-----|-----|-----|------|
| 潜在ユーザー | <1K | 1K-10K | 10K-100K | 100K-1M | >1M |
| 利用頻度 | 年1回 | 月1回 | 週1回 | 日1回 | 常時 |
| 緊急性 | あれば便利 | 時々困る | よく困る | 毎日困る | ないと死ぬ |

→ 3項目の平均 = PUGEFスコア

**ICE（10点満点）:**
| 基準 | 2点 | 4点 | 6点 | 8点 | 10点 |
|------|-----|-----|-----|-----|------|
| Impact | 微改善 | 小改善 | 中改善 | 大改善 | 革新的 |
| Confidence | 仮説のみ | 類似例あり | エビデンス1つ | 複数エビデンス | 実証済み |
| Ease | 3ヶ月+ | 1-3ヶ月 | 2-4週 | 1-2週 | 数日 |

→ 3項目の平均 = ICEスコア

**Market（10点満点）:**
| 基準 | 2点 | 4点 | 6点 | 8点 | 10点 |
|------|-----|-----|-----|-----|------|
| 市場規模 | ニッチ中のニッチ | 小ニッチ | ニッチ | 中規模 | 大規模 |
| 成長性 | 縮小 | 横ばい | 微成長 | 成長 | 急成長 |
| 収益性 | 広告のみ | ¥500以下 | ¥500-2K | ¥2K-5K | ¥5K+ |

**エビデンスなし = Marketスコア上限5**

**Advantage（10点満点）:**
| 基準 | 2点 | 4点 | 6点 | 8点 | 10点 |
|------|-----|-----|-----|-----|------|
| 差別化 | なし | 微差 | 1つ明確 | 2つ以上 | 独自カテゴリ |
| 模倣困難 | 即コピー可 | 1週間 | 1ヶ月 | 数ヶ月 | 困難 |
| 技術優位 | 汎用技術 | 組合せ技 | 専門知識要 | 独自アルゴ | 特許級 |

**差別化ポイントを3つ挙げられない = Advantageスコア上限5**

#### 総合スコア = 4軸の平均

- **7.5以上:** 実装仕様書生成に進む
- **6.0-7.4:** 1回改善イテレーション（弱い軸を強化）
- **6.0未満:** 却下。学びだけ記録して次へ

### Step 5: 実装仕様書（MD）生成

スコア7.5+のアイデアのみ。以下のフォーマットで生成:

```markdown
# {プロジェクト名}

## 概要
{1-2文の説明}

## エビデンス
- {根拠1: URL + 要点}
- {根拠2: URL + 要点}

## 評価スコア
| 軸 | スコア | 根拠 |
|----|--------|------|
| PUGEF | X.X | ... |
| ICE | X.X | ... |
| Market | X.X | ... |
| Advantage | X.X | ... |
| **総合** | **X.X** | |

## 技術スタック
- {使用技術}

## UI設計
- スタイル: {具体的スタイル名。AI感排除。}
- カラー: {具体的カラーコード}
- フォント: {Google Fontsから}
- 参考: {参考サイトURL}

## 機能仕様
### MVP（2週間以内）
1. {機能1}
2. {機能2}
3. {機能3}

### Phase 2（将来）
- {追加機能}

## 実装手順
1. {ステップ1}
2. {ステップ2}
...

## ファイル構成
```
projects/{project-name}/
├── index.html
├── README.md
└── design-spec.yaml
```

## 注意事項
- {技術的注意点}
- {デザイン上の注意点}
```

### Step 6: 投稿と通知

**#lab に投稿:**
```
💡 新アイデア提案: {タイトル}

📊 スコア: {総合}/10.0
🏷 カテゴリ: {カテゴリ}
🔍 着想: {メソッド名}
📎 エビデンス: {URL 1-2個}

{アイデアの2-3行サマリー}

---
実装仕様書（全文）:
```markdown
{MD仕様書全文}
```（ここまで）

マスターの承認後、Claude Code Agentに転送してください。
```

**#setting に通知:**
```
🪽 新しいアイデア仕様書を #lab に投稿しました。
確認して、よければClaude Code Agentに転送お願いします。
```

### Step 7: 学び記録（必須・スキップ不可）

`memory/idea-learning.md` に追記:

```markdown
### {日付} {slot} — {タイトル}
- カテゴリ: {X}
- メソッド: {A-F}
- スコア: {X.X}
- 最も有用だったエビデンス: {URL}
- 反省: {評価は甘くなかったか？着想に新しさはあったか？}
- マスター反応: （後日追記）
```

### Step 8: State更新

`memory/auto-idea-state.json` を更新。

**必須: `heartbeat-state.json` も同期更新する。**
```python
import json, time
hb_path = "memory/heartbeat-state.json"
hb = json.load(open(hb_path))
slot = "idea_morning" or "idea_evening"  # 実行スロットに応じて
hb["lastChecks"][slot] = int(time.time())
json.dump(hb, open(hb_path, "w"), indent=2)
```
これにより、cron経由でもheartbeat経由でも状態が一貫する。

---

## Vault既存アイデアの処理

`/mnt/vault/10-Ideas/` に未処理ファイルがある場合:
- 既存アイデアを **Step 4 から** 開始（リサーチはスキップ）
- エビデンスが必要な場合はその場でweb_search
- 処理後 `.processed/{filename}.done` マーカー作成
- **供給源①（Vault）と②（自律生成）を交互に回す**
  - 朝: 自律生成
  - 夜: Vaultから（ストックがあれば）。なければ自律生成

---

## エラー時

```
⚠️ idea-workflow エラー
📍 {Step番号}
💬 {内容}
→ idea-learning.md に記録して次回に活かす
```
